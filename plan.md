# 实现多场景重复检测功能

## 功能需求

- 输入Excel文件，包含"国家"、"企业名称"、"网址"等列
- 逐行与其他所有行比较，检测6种重复场景
- 为每行添加"备注"列，标记所有匹配的场景（用分隔符连接）
- 非重复行标记"无重复"
- 输出两个Excel文件：

  1. 完整文件：包含所有行和所有备注
  2. 重复文件：只包含有重复的行（备注不是"无重复"）

## 实现方案

### 核心函数设计

在 `excel_duplicates.py` 中添加新函数 `detect_duplicate_scenarios()`：

**函数签名：**

```python
def detect_duplicate_scenarios(
    input_path: PathLike,
    output_full_path: PathLike,
    output_duplicates_path: PathLike,
    country_col: str = "国家",
    company_col: str = "企业名称",
    website_col: str = "网址",
    note_col: str = "备注",
    scenario_separator: str = "；"
) -> tuple[pd.DataFrame, pd.DataFrame]
```

### 实现逻辑

1. **读取Excel文件**

   - 使用 `pd.read_excel()` 读取所有列
   - 验证必需列是否存在

2. **逐行比较逻辑**

   - 对每一行，与所有其他行进行比较
   - 检测6种场景：
     - 场景1：国家相同 && 企业名称相同 && 网址相同 → "完全一致"
     - 场景2：国家相同 && 企业名称相同 && 网址不同 → "国家与名称一致，网址不一致"
     - 场景3：国家相同 && 企业名称不同 && 网址相同 → "国家与网址一致，名称不一致"
     - 场景4：国家不同 && 企业名称相同 && 网址相同 → "国家不一致，名称与网址一致"
     - 场景5：国家不同 && 企业名称相同 && 网址不同 → "国家与网址不一致，名称一致"
     - 场景6：国家不同 && 企业名称不同 && 网址相同 → "国家与名称不一致，网址一致"

3. **备注生成**

   - 初始化备注列为空列表
   - 对每行，收集所有匹配的场景描述
   - 如果没有任何匹配，标记为"无重复"
   - 如果有多个匹配，用分隔符（默认"；"）连接

4. **输出文件**

   - 文件1（完整）：包含所有行和备注列，保存到 `output_full_path`
   - 文件2（重复）：筛选备注列不等于"无重复"的行，保存到 `output_duplicates_path`

### 性能优化考虑

- 对于大数据量，逐行比较可能较慢（O(n²)复杂度）
- 可以考虑使用分组优化，但当前先实现基础版本

### 文件修改

- 修改 `excel_duplicates.py`：添加新函数
- 更新 `__main__` 部分：添加新功能的示例调用

